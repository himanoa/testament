<!DOCTYPE html>
<html lang="" dir="ltr">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Windows Subsystem for Linuxで開発環境を整えた &middot; 遺言書</title>
  <meta name="description" content="

&lt;blockquote class=&#34;twitter-tweet&#34; data-partner=&#34;tweetdeck&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;WSLあらかた満足した &lt;a href=&#34;https://t.co/y9LBA797Qg&#34;&gt;pic.twitte" />
  <meta property="og:type" content="article">
  <meta name="twitter:card" content="

&lt;blockquote class=&#34;twitter-tweet&#34; data-partner=&#34;tweetdeck&#34;&gt;&lt;p lang=&#34;ja&#34; dir=&#34;ltr&#34;&gt;WSLあらかた満足した &lt;a href=&#34;https://t.co/y9LBA797Qg&#34;&gt;pic.twitte">
  <meta property="og:image" content="default.jpg">
  <meta property="twitter:image" content="default.jpg">
  <meta property="og:url" content="https://blog.himanoa.net/19/" >
  <meta property="og:title" content="Windows Subsystem for Linuxで開発環境を整えた &middot; 遺言書" >
  <meta property="twitter:title" content="Windows Subsystem for Linuxで開発環境を整えた &middot; 遺言書" >
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  
  
  <link href="https://blog.himanoa.net/css/style.min.css" rel="stylesheet">
  <link href="https://blog.himanoa.net/css/xcode.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
  
  
</head>

  <body class="single-body">
    <nav class="nav-bar side-padding">
  <div class="nav-bar-inside">
    <a href="https://blog.himanoa.net" class="nav-large-text">Testament</a>
  </div>
</nav>

    <main class="content side-text-padding">
      <article class="post dropcase">
        <header class="post-header">
        	<h1 class="post-title">Windows Subsystem for Linuxで開発環境を整えた</h1>
          <p class="post-date">Posted <time datetime="2018-02-09">Feb 9, 2018</time></p>
        </header>
        
        

<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="ja" dir="ltr">WSLあらかた満足した <a href="https://t.co/y9LBA797Qg">pic.twitter.com/y9LBA797Qg</a></p>&mdash; Internet Subscriber (@h1manoa) <a href="https://twitter.com/h1manoa/status/958485588339965952?ref_src=twsrc%5Etfw">January 30, 2018</a></blockquote>

<p>ndenv とか pyenv とか rbenv とか tmux とか fish とか neovim とか fzf とか色々動いたし、True Color出せるということもわかったので、まぁ常用はできるんじゃないですかね？といった所。常用するかどうかは知らん。まだ課題点もいろいろあるし。</p>

<h2 id="導入">導入</h2>

<p>WSLチュートリアルがあるので これ通りやった。 <a href="https://github.com/QMonkey/wsl-tutorial">https://github.com/QMonkey/wsl-tutorial</a></p>

<p>XWindowSystemが必要なアプリケーションを使う予定がないならXLaunch入れたりとかはしなくていいとは思う</p>

<p>あとは普通のUbuntuなので必要なアプリケーションをインストールしていくだけ。</p>

<p>僕の環境は多分大体以下のコマンドで再現できると思う</p>

<pre><code>sudo apt-get install software-properties-common
sudo apt-add-repository ppa:fish-shell/release-2
sudo add-apt-repository ppa:neovim-ppa/unstable
sudo apt-get update &amp;&amp; sudo apt-get install neovim fish tmux go git build-essential openssl libssl-dev libbz2-dev libreadline-dev libsqlite-dev gcc python-build

git clone https://github.com/sstephenson/rbenv.git ~/.rbenv
git clone https://github.com/sstephenson/ruby-build.git ~/.rbenv/plugins/ruby-build
git clone https://github.com/riywo/ndenv ~/.ndenv
git clone https://github.com/riywo/node-build.git ~/.ndenv/plugins/node-build
git clone https://github.com/yyuu/pyenv.git ~/.pyenv
git clone https://github.com/yyuu/pyenv-virtualenv.git ~/.pyenv/plugins/pyenv-virtualenv
</code></pre>

<p>惰性で各envそれぞれインストールしてるけどanyenvとか使う方が絶対筋いいのでそっちにしような</p>

<h2 id="はまったこと">はまったこと</h2>

<h3 id="pecoが動かん">pecoが動かん</h3>

<p>pecoのLinuxビルド持ってきて叩いてみたら</p>

<pre><code>Failed to execute process '/usr/bin/peco'. Reason:
exec: Exec format error
The file '/usr/bin/peco' is marked as an executable but could not be run by the operating system.
</code></pre>

<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="ja" dir="ltr">WSL は /dev/tty の fcntl(fd, F_SETOWN, pid) が出来ないので色々と辛い。</p>&mdash; コーテルイーナーホー (@mattn_jp) <a href="https://twitter.com/mattn_jp/status/897277502472601601?ref_src=twsrc%5Etfw">August 15, 2017</a></blockquote>

<p>pecoにPR投げるのが得策なのはそれはそうなんですけど、時間もなければGoがわからないので普通に迂回してfzfで代替することにした。tmux連携とかvim連携あるらしくてこっちの方がいいかも感出てきた。</p>

<p>ちなみに僕の場合はpeco -&gt; fzfは fzfをインストールして peco使うコードが書いてあるファイルで <code>:%s/peco/fzf-tmux/g</code> しただけで移行終了した。よかった</p>

<h3 id="systemd動いてはいるけど様子がおかしい">systemd動いてはいるけど様子がおかしい</h3>

<p><code>systemctl status acpid.service</code> とか叩いてみると</p>

<pre><code>Failed to get properties: Launch helper exited with unknown return code 1
</code></pre>

<p>になる。 WSLはGitHubがあるので issue見てたら見つけた</p>

<p><a href="https://github.com/Microsoft/WSL/issues/1579">https://github.com/Microsoft/WSL/issues/1579</a></p>

<p>service使おねということらしい</p>

<h3 id="chsh見てくれない">chsh見てくれない</h3>

<p>これ本当に最悪なんですけどWSLちゃんはなんかchsh効きません。僕は 泣く泣く <code>.bashrc</code> に <code>fish &amp;&amp; exit</code>を書きました</p>

<p>** 追記 **</p>

<p><code>exec fish</code> にするとbashのプロセスが置き変わるので便利らしいですね</p>

<h2 id="ターミナルエミュレータどうするよ問題">ターミナルエミュレータどうするよ問題</h2>

<p>Windowsは残念なことにまともなターミナルエミュレータが存在しないと思い込んでたが、<a href="https://github.com/goreliu/wsl-terminal">https://github.com/goreliu/wsl-terminal</a> が比較的まともっぽいので入れた。これがなかったら正直WSLで開発とかしようと思わなかったと思う。</p>

<p>導入法はWSL側のUsername と Passwordの設定が終わった段階で <code>bash -c &quot;wget https://github.com/goreliu/wsl-terminal/releases/download/v0.8.7/wsl-terminal-0.8.7.7z &amp;&amp; 7z x wsl-terminal-0.8.7.7z&quot;</code> をするだけ。あとはスタートメニューに、 Ubuntu Terminalが召喚されるので、そいつを起動するだけ。右クリック -&gt; Optionsで色々弄れるので下のようにしとくとよい</p>

<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="ja" dir="ltr">WSL Terminalおすすめ設定ちゃんです <a href="https://t.co/UxCgidYkQY">pic.twitter.com/UxCgidYkQY</a></p>&mdash; Internet Subscriber (@h1manoa) <a href="https://twitter.com/h1manoa/status/958500916671406080?ref_src=twsrc%5Etfw">January 31, 2018</a></blockquote>

<h2 id="総括">総括</h2>

<p>常用できるWSL環境を整えられたということがわかる。</p>

<p>WSLのUbuntuの挙動はかなり癖があるが、まぁ普通にLinux使ってきた皆さんならあんまり問題にならないよねといった物ばかりなのでこれを期に開発マシンでUbuntuとか使ってた人たちはWSL試してみては？</p>

<p>かなりサクッと導入できて便利なんですけどプログラミング初心者とかにとりあえずWSL入れてねって勧められる程の出来ではない感じだと思った。</p>

<h2 id="課題点">課題点</h2>

<ul>
<li>Windows + tmuxでのクリップボード共有設定について煮つめられていない。 -&gt; <a href="https://blog.himanoa.net/entries/20/">続編</a></li>
<li>職場のWindowsマシンマンがvagrantで作業しているのがしんどそうなので導入してもらいたい -&gt; 手オペレーションは日本語を書かなくちゃでしんどいのでMitamaeとか使ってバンドカバンで入るようにしたい</li>
<li>Docker動くのかこれ…？</li>
</ul>

<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="ja" dir="ltr">wsl一番のクソポイントとして、dockerが動かない</p>&mdash; ぱくとま (@pakutoma) <a href="https://twitter.com/pakutoma/status/958501922314469376?ref_src=twsrc%5Etfw">January 31, 2018</a></blockquote>

        <section class="section">
  <h2>欲求ボタン</h2>
  <div class="sns-buttons">
    <a class="sns" href="http://twitter.com/intent/tweet?url=https%3a%2f%2fblog.himanoa.net%2f19%2f&text=Windows%20Subsystem%20for%20Linux%e3%81%a7%e9%96%8b%e7%99%ba%e7%92%b0%e5%a2%83%e3%82%92%e6%95%b4%e3%81%88%e3%81%9f" target="_blank" title="Tweet"><i class="fab fa-twitter fa-2x"></i></a>
    <a class="sns" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fblog.himanoa.net%2f19%2f&t=Windows%20Subsystem%20for%20Linux%e3%81%a7%e9%96%8b%e7%99%ba%e7%92%b0%e5%a2%83%e3%82%92%e6%95%b4%e3%81%88%e3%81%9f" target="_blank" title="Facebook"><i class="fab fa-facebook fa-2x"></i></a>
    <a class="sns" href="http://getpocket.com/edit?url=https%3a%2f%2fblog.himanoa.net%2f19%2f&title=Windows%20Subsystem%20for%20Linux%e3%81%a7%e9%96%8b%e7%99%ba%e7%92%b0%e5%a2%83%e3%82%92%e6%95%b4%e3%81%88%e3%81%9f" target="_blank" title="pocket"><i class="fab fa-get-pocket fa-2x"></i></a>
  </div>
</section>

      </article>
      
    </main>
  </body>
</html>
